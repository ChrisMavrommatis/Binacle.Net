@using Binacle.Net.Api.UIModule.Components.Features
@using Binacle.Net.Api.UIModule.Components.Shared.Forms

@rendermode RenderMode.InteractiveServer

@page "/ProtocolDecoder"

<PageTitle>Protocol Decoder</PageTitle>

<h1>Protocol Decoder</h1>


<div class="grid">
	<article class="no-padding transparent s12 m5 l3">
		<article class="medium top-round">
			<InputTextAreaField Id="AddResult" Label="Add Result" @bind-Value="@Model.AddResult" ContainerFieldClass="border max-height" class="word-wrap"/>
		</article>
		<div>
			<nav class="no-space">
				<button type="button" class="border class max bottom-round" @onclick="this.AddResult">
					<MaterialSymbol Name="library_add"/>
				</button>
			</nav>
		</div>
	</article>


	<div class="s12 m7 l9">
		<PackingVisualizer InitialBin="this.selectedResult?.Bin"/>
	</div>
	<div class="s12">
		<fieldset class="scroll" style="block-size: 30rem;">
			<legend>Saved Results</legend>
			@if (this.results.Count == 0)
			{
				<span>No Results</span>
			}
			else
			{
				@foreach (var (key, result) in this.results)
				{
					<a class="row wave padding max @(IsSelected(result) ? $"surface-container border" : string.Empty)"
					   @onclick="@(() => this.SelectResult(result))">
						<MaterialSymbol Name="package_2"/>

						<div class="max">
							Bin: @result.Bin!.ID
						</div>
						<button type="button" class="transparent circle" style="z-index:10"
						        @onclick="@(() => this.DeleteResult(result))"
						        @onclick:stopPropagation="true">
							<MaterialSymbol Name="delete"/>
						</button>
					</a>
				}
			}
		</fieldset>
	</div>
</div>

<ErrorsDialog @bind-Errors="@this.errors" />
